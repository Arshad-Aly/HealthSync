{% extends "main.html" %}

{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f9fafb;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        header {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 1rem 0;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }

        .logo {
            color: #7c3aed;
            font-size: 1.25rem;
            font-weight: bold;
            text-decoration: none;
        }

        .search-container {
            position: relative;
            flex: 1;
            max-width: 36rem;
        }

        .search-input {
            width: 100%;
            padding: 0.5rem 0.75rem 0.5rem 2.5rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.375rem;
            outline: none;
        }

        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            border: none;
            cursor: pointer;
            font-size: 0.875rem;
        }

        .btn-primary {
            background-color: #7c3aed;
            color: white;
        }

        .btn-primary:hover {
            background-color: #6d28d9;
        }

        .btn-icon {
            padding: 0.5rem;
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
        }

        .avatar {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background-color: #e5e7eb;
        }

        .filters {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            background-color: #f3f4f6;
            color: #4b5563;
            font-size: 0.875rem;
            cursor: pointer;
        }

        .badge-purple {
            background-color: #ddd6fe;
            color: #7c3aed;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            padding: 1.5rem 0;
        }

        .map-container {
            position: relative;
            height: 600px;
            background-color: #f3f4f6;
            border-radius: 0.5rem;
        }

        #map {
            height: 80vh;
        }

        .map-search {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background: white;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .property-card {
            background: white;
            border-radius: 0.5rem;
            overflow: hidden;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
        }

        .property-content {
            display: flex;
            gap: 1rem;
            padding: 1rem;
        }

        .property-image {
            width: 120px;
            height: 120px;
            border-radius: 0.5rem;
            object-fit: cover;
        }

        .property-details {
            flex: 1;
        }

        .property-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .property-title {
            font-weight: 600;
        }

        .property-address {
            color: #6b7280;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
        }

        .property-features {
            display: flex;
            gap: 1rem;
            color: #6b7280;
            font-size: 0.875rem;
        }

        .property-price {
            margin-top: 0.5rem;
        }

        .discount-card {
            position: relative;
            height: 200px;
            border-radius: 0.5rem;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .discount-content {
            position: absolute;
            inset: 0;
            background: linear-gradient(to right, rgba(124, 58, 237, 0.8), rgba(124, 58, 237, 0.4));
            color: white;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .marker-green {
            background-color: #22c55e;
            border-radius: 50%;
            border: 2px solid white;
        }
        
        .marker-yellow {
            background-color: #eab308;
            border-radius: 50%;
            border: 2px solid white;
        }
        
        .marker-red {
            background-color: #ef4444;
            border-radius: 50%;
            border: 2px solid white;
        }

        .availability-popup {
            text-align: center;
            padding: 5px;
        }

        .availability-popup strong {
            display: block;
            margin-bottom: 5px;
        }

        .availability-popup span {
            display: block;
            font-size: 0.9em;
            color: #666;
        }

        .booking-panel {
            position: fixed;
            right: 0;
            top: 0;
            height: 100%;
            width: 384px;
            background: white;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .booking-panel.open {
            transform: translateX(0);
        }

        .toggle-button {
            padding-left: 12px;
            position: fixed;
            right: 37px;
            top: 50%;
            transform: translateY(-50%) rotate(90deg);
            transform-origin: right;
            background: #2563eb;
            color: white;
            border: none;
            padding: 12px 20px;
            cursor: pointer;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toggle-button:hover {
            background: #1d4ed8;
        }

        /* Card styles */
        .card {
            height: 100%;
        }

        .card-header {
            position: sticky;
            top: 0;
            background: white;
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            z-index: 10;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e40af;
        }

        .close-button {
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 8px;
        }

        /* Form styles */
        .card-content {
            padding: 1.5rem;
        }

        .form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
        }

        .input-wrapper {
            position: relative;
        }

        .input, .select, .textarea {
            width: 100%;
            padding: 0.5rem 0.75rem;
            padding-left: 2.5rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.375rem;
            font-size: 0.875rem;
        }

        .textarea {
            min-height: 100px;
            padding-left: 0.75rem;
            resize: vertical;
        }

        .select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='currentColor'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.5rem center;
            background-size: 1.5em 1.5em;
        }

        .input:focus, .select:focus, .textarea:focus {
            outline: none;
            border-color: #2563eb;
            ring: 2px solid rgba(37, 99, 235, 0.2);
        }

        .icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
            width: 1.25rem;
            height: 1.25rem;
        }

        .submit-button {
            width: 100%;
            padding: 0.75rem;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 0.375rem;
            font-weight: 500;
            cursor: pointer;
        }

        .submit-button:hover {
            background: #1d4ed8;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo">HealthSync AI</a>
                <div class="search-container">
                    <i class="lucide-search search-icon"></i>
                    <input type="text" class="search-input" placeholder="Search hospitals, clinics, diagnostics and etc.">
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary">Make a Call</button>
                    <button class="btn-icon"><i class="lucide-heart"></i></button>
                    <button class="btn-icon"><i class="lucide-bell"></i></button>
                    <div class="avatar"></div>
                </div>
            </div>
            
            <div class="filters">
                <span class="badge">All</span>
                <span class="badge">Distance</span>
                <span class="badge badge-purple">Neurology</span>
                <span class="badge">Rating</span>
                <span class="badge">Orthopedics</span>
                <span class="badge">Cardiology</span>
                <span class="badge">Pediatrics</span>
                <span class="badge">Dermatalogist</span>
                <button class="btn-icon" style="margin-left: auto;">
                    <i class="lucide-sliders-horizontal"></i> Filters
                </button>
            </div>
        </div>
    </header>

    <main class="container main-content">

        <div class="map-container">
            <div id="map" class="w-full h-full z-0"></div>
        </div>

        <div>

            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                {% comment %} <span style="color: #6b7280;">350+ stays in map area</span> {% endcomment %}
                <div style="display: flex; gap: 1rem;">
                    <button class="btn">
                        <i class="lucide-calendar"></i>
                        21 Feb 2025 - 28 Feb 2025
                    </button>
                </div>
            </div>

            <div class="discount-card">
                <div class="discount-content">
                    <h3 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem;">Priority Health Check</h3>
                    <p style="font-size: 2.25rem; font-weight: bold; margin-bottom: 0.5rem;">Book Your Appointment Now</p>
                    <p style="margin-bottom: 1rem;">Get a free initial consultation</p>
                    <button class="btn btn-primary">Book now</button>
                </div>
            </div>

            <div class="property-card">
                <div class="property-content">
                    <img src="/api/placeholder/120/120" alt="Property" class="property-image">
                    <div class="property-details">
                        <div class="property-header">
                            <div>
                                <span class="badge">4.7</span>
                                <span class="property-title">Sunset Medical Center</span>
                            </div>
                            <button class="btn-icon"><i class="lucide-heart"></i></button>
                        </div>
                        <p class="property-address">2456 Royal Ln. Mesa,Hyderabad</p>
                        <div class="property-features">
                        </div>
                        <div class="property-price">
                            <span style="font-weight: 600; font-size: 1.125rem;">Price</span>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <button class="toggle-button" onclick="togglePanel()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
        Book Appointment
    </button>

    <div class="booking-panel" id="bookingPanel">
        <div class="card">
            <div class="card-header">
                <div class="header-content">
                    <h2 class="card-title">Book Your Appointment</h2>
                    <button class="close-button" onclick="togglePanel()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="card-content">
                <form class="form" onsubmit="handleSubmit(event)">
                    <div class="form-group">
                        <label class="label" for="name">Full Name</label>
                        <div class="input-wrapper">
                            <input id="name" type="text" name="name" required class="input">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="label" for="email">Email Address</label>
                        <div class="input-wrapper">
                            <input id="email" type="email" name="email" required class="input">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                                <polyline points="22,6 12,13 2,6"></polyline>
                            </svg>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="label" for="phone">Phone Number</label>
                        <div class="input-wrapper">
                            <input id="phone" type="tel" name="phone" required class="input">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                            </svg>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="label" for="dob">Date of Birth</label>
                        <div class="input-wrapper">
                            <input id="dob" type="date" name="dob" required class="input">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="label" for="gender">Gender</label>
                        <select id="gender" name="gender" required class="select">
                            <option value="" disabled selected>Select Gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="label" for="reason">Reason for Visit</label>
                        <textarea id="reason" name="reason" required class="textarea"></textarea>
                    </div>

                    <button type="submit" class="submit-button">Book Appointment</button>
                </form>
            </div>
        </div>
    </div>

    <div style="width: 0; height: 0;" id="VG_OVERLAY_CONTAINER">
        
    </div>
    {% comment %} <script>

            scrape-data = {
                "metadata": {
                  "specialty": "neurosurgery",
                  "total_doctors": 30,
                  "scrape_timestamp": "2025-02-21T19:43:52.749288"
                },
                "doctors": [
                  {
                    "latitude": 16.870054,
                    "longitude": 79.56254,
                    "id": "dr-amit-kapoor-e830cf57-3ac0-4f78-bb72-3f62beb208ed?source=Listing_Page",
                    "name": "Dr. Amit Kapoor",
                    "specialty": "Neurosurgeon",
                    "experience": "18 Years",
                    "qualifications": "D.N.B NeuroSurg.",
                    "city": "Delhi",
                    "clinic": "Apollo Hospitals Indraprastha, Delhi",
                    "consultations": {
                      "digital": {
                        "price": "₹1500",
                        "availability": "Not specified"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-amit-kapoor-e830cf57-3ac0-4f78-bb72-3f62beb208ed?source=Listing_Page"
                  },
                  {
                    "latitude": 17.342864,
                    "longitude": 78.506943,
                    "id": "dr-amit-kapoor-271f1b85-dd51-468b-9271-20cb5d387da2?source=Listing_Page",
                    "name": "Dr. Amit Kapoor",
                    "specialty": "Neurosurgeon",
                    "experience": "18 Years",
                    "qualifications": "D.N.B NeuroSurg.",
                    "city": "Noida",
                    "clinic": "Apollo Hospitals Sector 26, Noida",
                    "consultations": {
                      "digital": {
                        "price": "₹1500",
                        "availability": "Available in 6 minutes"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-amit-kapoor-271f1b85-dd51-468b-9271-20cb5d387da2?source=Listing_Page"
                  },
                  {
                    "latitude": 18.035563,
                    "longitude": 79.629879,
                    "id": "dr-aditendraditya-singh-bhati-ae892c6c-38b1-42a7-a4c4-629701ccd166?source=Listing_Page",
                    "name": "Dr. Aditendraditya Singh Bhati",
                    "specialty": "Neurosurgeon",
                    "experience": "18 Years",
                    "qualifications": "MBBS(2004), DNB Neurosurgery(2014); MNAMS; Fellow Neuroendoscopy",
                    "city": "Delhi",
                    "clinic": "Apollo Hospitals Indraprastha, Delhi",
                    "rating": "86%",
                    "recommendations": "50+ recommendations",
                    "consultations": {
                      "digital": {
                        "price": "₹1000",
                        "availability": "Not specified"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-aditendraditya-singh-bhati-ae892c6c-38b1-42a7-a4c4-629701ccd166?source=Listing_Page"
                  },
                  {
                    "latitude": 18.45692,
                    "longitude": 79.135035,
                    "id": "dr-bharat-subramanya-16cbce91-5813-4d67-92ba-174b426cb666?source=Listing_Page",
                    "name": "Dr. Bharat Subramanya",
                    "specialty": "Neurosurgeon",
                    "experience": "8 Years",
                    "qualifications": "MBBS, DrNB Neurosurgery (D6Y,NBEMS), Fellowship Park clinic Kolkata",
                    "city": "Bengaluru",
                    "clinic": "Apollo Clinic, Electronic City, Bengaluru",
                    "consultations": {
                      "digital": {
                        "price": "₹1050",
                        "availability": "Available in 16 minutes"
                      },
                      "clinic": {
                        "price": "₹1050",
                        "availability": "Available in 2 days"
                      }
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-bharat-subramanya-16cbce91-5813-4d67-92ba-174b426cb666?source=Listing_Page"
                  },
                  {
                    "latitude": 17.399805,
                    "longitude": 78.47915,
                    "id": "dr-sanatan-satapathy-20eb06f2-2cc7-47e8-928d-5c94b0af06f5?source=Listing_Page",
                    "name": "Dr. Sanatan Satapathy",
                    "specialty": "Neurosurgeon",
                    "experience": "10 Years",
                    "qualifications": "MBBS , MS (General surgery) , MCH (Neurosurgery)",
                    "city": "Bhubaneswar",
                    "clinic": "Dr Sanatan Satapathy, Bhubaneswar",
                    "consultations": {
                      "digital": null,
                      "clinic": {
                        "price": "₹500",
                        "availability": "Available in 16 minutes"
                      }
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-sanatan-satapathy-20eb06f2-2cc7-47e8-928d-5c94b0af06f5?source=Listing_Page"
                  },
                  {
                    "latitude": 18.035563,
                    "longitude": 79.629879,
                    "id": "dr-abhay-sikaria-710873bf-8b1d-405f-9fef-534343e5897c?source=Listing_Page",
                    "name": "Dr Abhay Sikaria",
                    "specialty": "Neurosurgeon",
                    "experience": "7 Years",
                    "qualifications": "MBBS, M.S (GENERAL SURGERY), MCH (NEUROSURGERY)",
                    "city": "Bengaluru",
                    "clinic": "Apollo Clinic, Koramangala, Bengaluru",
                    "consultations": {
                      "digital": {
                        "price": "₹850",
                        "availability": "Available in 16 minutes"
                      },
                      "clinic": {
                        "price": "₹850",
                        "availability": "Available tomorrow at 10:30 AM"
                      }
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-abhay-sikaria-710873bf-8b1d-405f-9fef-534343e5897c?source=Listing_Page"
                  },
                  {
                    "latitude": 17.342864,
                    "longitude": 78.506943,
                    "id": "dr-abinash-dutta-5288524f-e838-4057-8f9c-c2e547329cfb?source=Listing_Page",
                    "name": "Dr. Abinash Dutta",
                    "specialty": "Neurosurgeon",
                    "experience": "10 Years",
                    "qualifications": "MBBS, MS - General Surgery, MCh - Neuro Surgery",
                    "city": "Bengaluru",
                    "clinic": "NeuroCare Clinic, Bengaluru",
                    "rating": "100%",
                    "recommendations": "50+ recommendations",
                    "consultations": {
                      "digital": {
                        "price": "₹1500",
                        "availability": "Available in 26 minutes"
                      },
                      "clinic": {
                        "price": "₹1200",
                        "availability": "Available in 36 minutes"
                      }
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-abinash-dutta-5288524f-e838-4057-8f9c-c2e547329cfb?source=Listing_Page"
                  },
                  {
                    "latitude": 18.45692,
                    "longitude": 79.135035,
                    "id": "dr-j-kartik-eshwar-01738ee3-5980-4f0e-9a54-d4efffa11f42?source=Listing_Page",
                    "name": "Dr J Kartik Eshwar",
                    "specialty": "Neurosurgeon",
                    "experience": "8 Years",
                    "qualifications": "MBBS, MS General Surgery, M.Ch Neurosurgery",
                    "city": "Tanuku",
                    "clinic": "Radha Krishna Neuro Multispeciality Hospital, Tanuku",
                    "consultations": {
                      "digital": {
                        "price": "₹700",
                        "availability": "Available in 36 minutes"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-j-kartik-eshwar-01738ee3-5980-4f0e-9a54-d4efffa11f42?source=Listing_Page"
                  },
                  {
                    "latitude": 17.342864,
                    "longitude": 78.506943,
                    "id": "dr-uddalak-chakraborty-b31803fc-4d4b-44fe-937e-8169a3b8afb7?source=Listing_Page",
                    "name": "Dr. Uddalak Chakraborty",
                    "specialty": "Neurologist",
                    "experience": "8 Years",
                    "qualifications": "MBBS,MD(GENL. MED.),DM(NEUROLOGY)",
                    "city": "Kolkata",
                    "clinic": "VDC Clinic, Kolkata",
                    "consultations": {
                      "digital": {
                        "price": "₹1500",
                        "availability": "Available in 56 minutes"
                      },
                      "clinic": {
                        "price": "₹1000",
                        "availability": "Available in 3 days"
                      }
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-uddalak-chakraborty-b31803fc-4d4b-44fe-937e-8169a3b8afb7?source=Listing_Page"
                  },
                  {
                    "latitude": 17.438335,
                    "longitude": 78.504831,
                    "id": "dr-shameem-ahmed-8986fe95-b77c-480a-b21d-484cd74c0848?source=Listing_Page",
                    "name": "Dr. Shameem Ahmed",
                    "specialty": "Neurosurgeon",
                    "experience": "24 Years",
                    "qualifications": "MCH (Neuro Surgery), MS(General Surgery), Brain and Spine Surgeon, MBBS",
                    "city": "Guwahati",
                    "clinic": "Apollo Hospitals G S Road, Guwahati",
                    "rating": "94%",
                    "recommendations": "50+ recommendations",
                    "consultations": {
                      "digital": {
                        "price": "₹1000",
                        "availability": "Not specified"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-shameem-ahmed-8986fe95-b77c-480a-b21d-484cd74c0848?source=Listing_Page"
                  },
                  {
                    "latitude": 17.399805,
                    "longitude": 78.47915,
                    "id": "dr-vigneshwar-ravisankar-5702c4ba-a608-4d9d-ad1f-575d233c9211?source=Listing_Page",
                    "name": "Dr. Vigneshwar Ravisankar",
                    "specialty": "Neurosurgeon",
                    "experience": "9 Years",
                    "qualifications": "M.B.B.S, MRCS (Eng), DNB (Gen. Surg), MCh (Neurosurgery), FNS (Japan).",
                    "city": "Chennai",
                    "clinic": "Apollo Speciality Hospitals OMR, Chennai",
                    "consultations": {
                      "digital": {
                        "price": "₹1000",
                        "availability": "Available tomorrow at 07:30 AM"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-vigneshwar-ravisankar-5702c4ba-a608-4d9d-ad1f-575d233c9211?source=Listing_Page"
                  },
                  {
                    "latitude": 18.035563,
                    "longitude": 79.629879,
                    "id": "dr-gaurav-tyagi-1a258739-30f5-47f5-950f-44e2ceb87014?source=Listing_Page",
                    "name": "Dr Gaurav Tyagi",
                    "specialty": "Neurosurgeon",
                    "experience": "8 Years",
                    "qualifications": "MBBS, MS, MCh (NIMHANS) Clinical Fellowship in Skull base Surgery",
                    "city": "Delhi",
                    "clinic": "Apollo Hospitals Indraprastha, Delhi",
                    "consultations": {
                      "digital": {
                        "price": "₹1500",
                        "availability": "Available tomorrow at 02:30 AM"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-gaurav-tyagi-1a258739-30f5-47f5-950f-44e2ceb87014?source=Listing_Page"
                  },
                  {
                    "latitude": 18.035563,
                    "longitude": 79.629879,
                    "id": "dr-joy-verghese-5f77a6d5-b1bc-48b3-be6a-574d0961f263?source=Listing_Page",
                    "name": "Dr. Joy Verghese",
                    "specialty": "Neurosurgeon",
                    "experience": "21 Years",
                    "qualifications": "MBBS, MS, MCH (Neuro surg. ), FMVS, FSS, FINR, MCH Neurosurgery (Mumbai University), FINR (Zurich University, Switzerland)",
                    "city": "Chennai",
                    "clinic": "Apollo Hospitals Greams Road, Chennai",
                    "consultations": {
                      "digital": {
                        "price": "₹1000",
                        "availability": "Not specified"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-joy-verghese-5f77a6d5-b1bc-48b3-be6a-574d0961f263?source=Listing_Page"
                  },
                  {
                    "latitude": 17.411482,
                    "longitude": 78.403532,
                    "id": "dr-shankar-ganesh-b8b8d221-1f2b-45ef-84f5-c810eecc86f5?source=Listing_Page",
                    "name": "Dr. Shankar Ganesh",
                    "specialty": "Neurosurgeon",
                    "experience": "12 Years",
                    "qualifications": "MBBS, M.S. (Gen. Surg.), Mch. (Neuro)",
                    "city": "Chennai",
                    "clinic": "Apollo Hospitals Cancer Centre Nandanam, Chennai",
                    "consultations": {
                      "digital": null,
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-shankar-ganesh-b8b8d221-1f2b-45ef-84f5-c810eecc86f5?source=Listing_Page"
                  },
                  {
                    "latitude": 17.342864,
                    "longitude": 78.506943,
                    "id": "dr-jaidev-s-a5b0d535-b407-48c6-912f-374fe82b2754?source=Listing_Page",
                    "name": "Dr. Jaidev S",
                    "specialty": "Neurosurgeon",
                    "experience": "7 Years",
                    "qualifications": "MBBS, MS ( Genera Surgery), MCH Neurolosurgery",
                    "city": "Bengaluru",
                    "clinic": "Apollo Clinic, Indiranagar, Bengaluru",
                    "consultations": {
                      "digital": {
                        "price": "₹700",
                        "availability": "Available tomorrow at 02:30 AM"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-jaidev-s-a5b0d535-b407-48c6-912f-374fe82b2754?source=Listing_Page"
                  },
                  {
                    "latitude": 17.342864,
                    "longitude": 78.506943,
                    "id": "dr-sunit-mediratta-5c7d9d85-807f-4980-a53f-211a4c0baa81?source=Listing_Page",
                    "name": "Dr. Sunit Mediratta",
                    "specialty": "Neurosurgeon",
                    "experience": "20 Years",
                    "qualifications": "MBBS, MS, MCh, DNB, MNAMS",
                    "city": "Delhi",
                    "clinic": "Apollo Hospitals Indraprastha, Delhi",
                    "consultations": {
                      "digital": {
                        "price": "₹2000",
                        "availability": "Not specified"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-sunit-mediratta-5c7d9d85-807f-4980-a53f-211a4c0baa81?source=Listing_Page"
                  },
                  {
                    "latitude": 18.45692,
                    "longitude": 79.135035,
                    "id": "dr-brig-prof-prafulla-kumar-sahoo-bef31e0b-354d-45a6-8497-990dad4dddc6?source=Listing_Page",
                    "name": "Dr. Brig. Prof. Prafulla Kumar Sahoo",
                    "specialty": "Neurologist",
                    "experience": "36 Years",
                    "qualifications": "MBBS ( Utkal ), MS ( General Surgery, AFMC-Pune ), MCh ( Neuro Surgery, AllMS, New Delhi ) . Chief Consultant - Brain, Neuro, Spine & Radio Surgery.",
                    "city": "Bhubaneswar",
                    "clinic": "Apollo Hospitals Old Sainik School Road, Bhubaneswar",
                    "rating": "85%",
                    "recommendations": "50+ recommendations",
                    "consultations": {
                      "digital": {
                        "price": "₹1000",
                        "availability": "Not specified"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-brig-prof-prafulla-kumar-sahoo-bef31e0b-354d-45a6-8497-990dad4dddc6?source=Listing_Page"
                  },
                  {
                    "latitude": 18.035563,
                    "longitude": 79.629879,
                    "id": "dr-vignesh-sayeerajan-6d6a7587-b7cd-4ab6-96c0-afad093ab4e7?source=Listing_Page",
                    "name": "Dr. Vignesh Sayeerajan",
                    "specialty": "Neurosurgeon",
                    "experience": "10 Years",
                    "qualifications": "M.B.B.S., M.S(General Surgery), MCh( Neurosurgery),Fellowship in Skull base and Cerebrovascular surgery(ACNS)",
                    "city": "Chennai",
                    "clinic": "Apollo Hospitals Cancer Centre Nandanam, Chennai",
                    "consultations": {
                      "digital": {
                        "price": "₹1000",
                        "availability": "Available tomorrow at 08:30 AM"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-vignesh-sayeerajan-6d6a7587-b7cd-4ab6-96c0-afad093ab4e7?source=Listing_Page"
                  },
                  {
                    "latitude": 18.45692,
                    "longitude": 79.135035,
                    "id": "dr-arvind-k-r-735096d9-c9ce-47db-bd5b-2918b3251cb3?source=Listing_Page",
                    "name": "Dr. Arvind K R",
                    "specialty": "Neurosurgeon",
                    "experience": "14 Years",
                    "qualifications": "MBBS, M.S, M.Ch. (Neuro Surgery).",
                    "city": "Chennai",
                    "clinic": "Apollo First Med Hospitals P H Road, Chennai",
                    "consultations": {
                      "digital": {
                        "price": "₹800",
                        "availability": "Available tomorrow at 03:30 AM"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-arvind-k-r-735096d9-c9ce-47db-bd5b-2918b3251cb3?source=Listing_Page"
                  },
                  {
                    "latitude": 17.342864,
                    "longitude": 78.506943,
                    "id": "dr-ayushman-satapathy-f88fbf85-ea1e-4e23-b909-62672eae15fc?source=Listing_Page",
                    "name": "Dr. Ayushman Satapathy",
                    "specialty": "Neurosurgeon",
                    "experience": "12 Years",
                    "qualifications": "MS (GENERAL SURGERY), M.Ch (NEUROSURGERY),(FELLOWSHIP SKULLBASE)",
                    "city": "Rourkela",
                    "clinic": "Apollo Hospitals, Rourkela, Rourkela",
                    "consultations": {
                      "digital": null,
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-ayushman-satapathy-f88fbf85-ea1e-4e23-b909-62672eae15fc?source=Listing_Page"
                  },
                  {
                    "latitude": 18.035563,
                    "longitude": 79.629879,
                    "id": "dr-arvind-k-r-735096d9-c9ce-47db-bd5b-2918b3251cb3?source=Listing_Page",
                    "name": "Dr. Arvind K R",
                    "specialty": "Neurosurgeon",
                    "experience": "14 Years",
                    "qualifications": "MBBS, M.S, M.Ch. (Neuro Surgery).",
                    "city": "Chennai",
                    "clinic": "Apollo First Med Hospitals P H Road, Chennai",
                    "consultations": {
                      "digital": {
                        "price": "₹800",
                        "availability": "Available tomorrow at 03:30 AM"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-arvind-k-r-735096d9-c9ce-47db-bd5b-2918b3251cb3?source=Listing_Page"
                  },
                  {
                    "latitude": 16.870054,
                    "longitude": 79.56254,
                    "id": "dr-chandrasekar-k-fe976312-c34a-4b37-b34a-fb508200ea00?source=Listing_Page",
                    "name": "Dr. Chandrasekar K",
                    "specialty": "Neurosurgeon",
                    "experience": "20 Years",
                    "qualifications": "MBBS, Mch",
                    "city": "Chennai",
                    "clinic": "Apollo Hospitals Cancer Centre Nandanam, Chennai",
                    "consultations": {
                      "digital": null,
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-chandrasekar-k-fe976312-c34a-4b37-b34a-fb508200ea00?source=Listing_Page"
                  },
                  {
                    "latitude": 18.45692,
                    "longitude": 79.135035,
                    "id": "dr-akhilesh-kumar-1e59b752-38f9-4016-bc93-112feef7838b?source=Listing_Page",
                    "name": "Dr. Akhilesh Kumar",
                    "specialty": "Neurosurgeon",
                    "experience": "7 Years",
                    "qualifications": "MS (Gen Surgery), MCh (Neurosurgery)",
                    "city": "Lucknow",
                    "clinic": "Apollomedics Super Speciality Hospital, Lucknow",
                    "consultations": {
                      "digital": null,
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-akhilesh-kumar-1e59b752-38f9-4016-bc93-112feef7838b?source=Listing_Page"
                  },
                  {
                    "latitude": 17.342864,
                    "longitude": 78.506943,
                    "id": "dr-diwakar-shankar-b57dcd2a-03bb-4adb-bce5-3f17284d92c7?source=Listing_Page",
                    "name": "Dr Diwakar Shankar",
                    "specialty": "Neurosurgeon",
                    "experience": "10 Years",
                    "qualifications": "MS (Gen Surgery), MCh (Neurosurgery),  DNB (Neurosurgery), Fellowship Spine Surgery",
                    "city": "Lucknow",
                    "clinic": "Apollomedics Super Speciality Hospital, Lucknow",
                    "consultations": {
                      "digital": null,
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-diwakar-shankar-b57dcd2a-03bb-4adb-bce5-3f17284d92c7?source=Listing_Page"
                  },
                  {
                    "latitude": 17.438335,
                    "longitude": 78.504831,
                    "id": "dr-drpradeep-b-837da5f6-f1ed-4aee-99b9-3d990b1661ff?source=Listing_Page",
                    "name": "Dr.pradeep B",
                    "specialty": "Neurosurgeon",
                    "experience": "5 Years",
                    "qualifications": "MBBS., MS., MCh ( Neurosurgery)*",
                    "city": "Chennai",
                    "clinic": "Apollo Hospitals Cancer Centre Nandanam, Chennai",
                    "consultations": {
                      "digital": {
                        "price": "₹1000",
                        "availability": "Available in 3 days"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-drpradeep-b-837da5f6-f1ed-4aee-99b9-3d990b1661ff?source=Listing_Page"
                  },
                  {
                    "latitude": 17.411482,
                    "longitude": 78.403532,
                    "id": "dr-aagnetia-vinoth-4122fadf-4323-4619-a18b-3f3844385e36?source=Listing_Page",
                    "name": "Dr A.agnetia Vinoth",
                    "specialty": "Neurosurgeon",
                    "experience": "8 Years",
                    "qualifications": "MS., MCh., Neurosurgery",
                    "city": "Chennai",
                    "clinic": "Apollo Hospitals Cancer Centre Nandanam, Chennai",
                    "consultations": {
                      "digital": {
                        "price": "₹1500",
                        "availability": "Available tomorrow at 03:30 AM"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-aagnetia-vinoth-4122fadf-4323-4619-a18b-3f3844385e36?source=Listing_Page"
                  },
                  {
                    "latitude": 17.411482,
                    "longitude": 78.403532,
                    "id": "dr-anand-kumar-mahapatra-a58e7736-ce7c-4e84-96f4-179c46a4a295?source=Listing_Page",
                    "name": "Dr. Anand Kumar Mahapatra",
                    "specialty": "Neurosurgeon",
                    "experience": "8 Years",
                    "qualifications": "MBBS, MS, MCh",
                    "city": "Chinagadila",
                    "clinic": "Apollo Hospitals Health City Unit, Chinagadila",
                    "rating": "96%",
                    "recommendations": "50+ recommendations",
                    "consultations": {
                      "digital": {
                        "price": "₹1000",
                        "availability": "Not specified"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-anand-kumar-mahapatra-a58e7736-ce7c-4e84-96f4-179c46a4a295?source=Listing_Page"
                  },
                  {
                    "latitude": 16.870054,
                    "longitude": 79.56254,
                    "id": "dr-brig-dr-saurabh-kumar-verma-a358f305-e2a6-4b1f-9914-3f0858146250?source=Listing_Page",
                    "name": "Brig. Dr. Saurabh Kumar Verma",
                    "specialty": "Neurosurgeon",
                    "experience": "22 Years",
                    "qualifications": "MS (General Surgery), MCh (Neurosurgery)",
                    "city": "Lucknow",
                    "clinic": "Apollomedics Super Speciality Hospital, Lucknow",
                    "rating": "95%",
                    "recommendations": "50+ recommendations",
                    "consultations": {
                      "digital": {
                        "price": "₹1000",
                        "availability": "Not specified"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-brig-dr-saurabh-kumar-verma-a358f305-e2a6-4b1f-9914-3f0858146250?source=Listing_Page"
                  },
                  {
                    "latitude": 17.399805,
                    "longitude": 78.47915,
                    "id": "dr-rahul-jain-2d21db30-82b2-4b17-b93d-9b1d303f8e5f?source=Listing_Page",
                    "name": "Dr. Rahul Jain",
                    "specialty": "Neurosurgeon",
                    "experience": "13 Years",
                    "qualifications": "MS,Mch, Fellow endoscopic spine & brain surgery",
                    "city": "Bhopal",
                    "clinic": "Apollo Sage Hospitals, Bhopal",
                    "consultations": {
                      "digital": {
                        "price": "₹800",
                        "availability": "Available tomorrow at 04:30 AM"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-rahul-jain-2d21db30-82b2-4b17-b93d-9b1d303f8e5f?source=Listing_Page"
                  },
                  {
                    "latitude": 17.438335,
                    "longitude": 78.504831,
                    "id": "dr-subrat-kumar-soren-320ac0df-8d60-468c-9a1b-4d1c31603155?source=Listing_Page",
                    "name": "Dr. Subrat Kumar Soren",
                    "specialty": "Neurosurgeon",
                    "experience": "2 Years",
                    "qualifications": "MCH NEUROSURGERY",
                    "city": "Karimnagar",
                    "clinic": "Apollo Reach Hospitals Railway Station Road, Karimnagar",
                    "consultations": {
                      "digital": {
                        "price": "₹1000",
                        "availability": "Not specified"
                      },
                      "clinic": null
                    },
                    "profile_url": "https://www.apollo247.com/doctors/dr-subrat-kumar-soren-320ac0df-8d60-468c-9a1b-4d1c31603155?source=Listing_Page"
                  }
                ]
              }

            var map = L.map('map')

            var openStreetMap = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            });
            
            var googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
                maxZoom: 20,
                subdomains: ['mt0','mt1','mt2','mt3']
            });
            
            var googleHybrid = L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}', {
                maxZoom: 20,
                subdomains: ['mt0','mt1','mt2','mt3']
            });
            
            var googleSat = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
                maxZoom: 20,
                subdomains: ['mt0','mt1','mt2','mt3']
            });
            
            var googleTerrain = L.tileLayer('http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}', {
                maxZoom: 20,
                subdomains: ['mt0','mt1','mt2','mt3']
            });
            
            openStreetMap.addTo(map);
            
            var baseLayers = {
                "OpenStreetMap": openStreetMap,
                "Google Streets": googleStreets,
                "Google Hybrid": googleHybrid,
                "Google Satellite": googleSat,
                "Google Terrain": googleTerrain
            };
            
            L.control.layers(baseLayers).addTo(map);
            
            L.marker([51.5, -0.09]).addTo(map)
                .bindPopup('*')
                .openPopup();
            
            var currentLayerIndex = 0;
            var layerInstances = Object.values(baseLayers);
            
            function changeLayer() {
                map.removeLayer(layerInstances[currentLayerIndex]);
                
                currentLayerIndex = (currentLayerIndex + 1) % layerInstances.length;
                
                layerInstances[currentLayerIndex].addTo(map);
            }

            function getLocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        function(position) {
                            const latitude = position.coords.latitude;
                            const longitude = position.coords.longitude;
                            
                            map.setView([latitude, longitude], 13);
                            
                            L.marker([latitude, longitude])
                                .addTo(map)
                                .bindPopup('Your Location')
                                .openPopup();
            
                            sendLocationToBackend(latitude, longitude);
                        },
                        function(error) {
                            console.error("Error getting location:", error);
                            map.setView([51.505, -0.09], 13);
                        }
                    );
                } else {
                    console.error("Geolocation is not supported by this browser.");
                    map.setView([51.505, -0.09], 13);
                }
            }
        
            document.addEventListener('DOMContentLoaded', getLocation);

            function getAvailabilityColor(availability) {
            if (!availability) return 'red';
            
            const availText = availability.toLowerCase();
            if (availText.includes('today') || availText.includes('1 day')) {
                return 'green';
            } else if (availText.includes('2 day')) {
                return 'yellow';
            }
            return 'red';
        }

        function createCustomMarker(color) {
            return L.divIcon({
                className: `marker-${color}`,
                html: '',
                iconSize: [15, 15]
            });
        }

        function loadDoctorData() {
            fetch('scrape-data.json')
                .then(response => response.json())
                .then(data => {
                    const bounds = L.latLngBounds();
                    
                    data.doctors.forEach(doctor => {
                        const availability = doctor.consultations.digital?.availability || 
                                        doctor.consultations.clinic?.availability || 
                                        'Not available';
                        
                        const availColor = getAvailabilityColor(availability);
                        const customMarker = createCustomMarker(availColor);
                        
                        const popupContent = `
                            <div class="availability-popup">
                                <strong>${doctor.name}</strong>
                                <span>${doctor.specialty}</span>
                                <span style="color: ${availColor === 'green' ? '#22c55e' : 
                                                    availColor === 'yellow' ? '#eab308' : 
                                                    '#ef4444'}">
                                    ${availability}
                                </span>
                            </div>
                        `;
                        
                        const marker = L.marker([doctor.latitude, doctor.longitude], {
                            icon: customMarker
                        }).bindPopup(popupContent);
                        
                        markers.push(marker);
                        marker.addTo(map);
                        bounds.extend([doctor.latitude, doctor.longitude]);
                    });
                    
                    map.fitBounds(bounds);
                })
                .catch(error => {
                    console.error('Error loading doctor data:', error);
                });
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadDoctorData();
        });
    </script> {% endcomment %}

    <script>

        (function() {
            window.VG_CONFIG = {
                ID: "gj7ogbdotd869jj7", 
                region: 'eu',
                render: 'bottom-right', 
                stylesheets: [
                    
                    "https://vg-bunny-cdn.b-cdn.net/vg_live_build/styles.css",
                    
                ],
            }
            var VG_SCRIPT = document.createElement("script");
            VG_SCRIPT.src = "https://vg-bunny-cdn.b-cdn.net/vg_live_build/vg_bundle.js";
            VG_SCRIPT.defer = true; 
            document.body.appendChild(VG_SCRIPT);
        })()

        var map = L.map('map');
        var markers = [];

        var openStreetMap = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors'
        });

        var googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
            maxZoom: 20,
            subdomains: ['mt0','mt1','mt2','mt3']
        });
        
        var googleHybrid = L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}', {
            maxZoom: 20,
            subdomains: ['mt0','mt1','mt2','mt3']
        });
        
        var googleSat = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
            maxZoom: 20,
            subdomains: ['mt0','mt1','mt2','mt3']
        });
        
        var googleTerrain = L.tileLayer('http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}', {
            maxZoom: 20,
            subdomains: ['mt0','mt1','mt2','mt3']
        });

        openStreetMap.addTo(map);

        var baseLayers = {
            "OpenStreetMap": openStreetMap,
            "Google Streets": googleStreets,
            "Google Hybrid": googleHybrid,
            "Google Satellite": googleSat,
            "Google Terrain": googleTerrain
        };

        L.control.layers(baseLayers).addTo(map);

        var currentLayerIndex = 0;
        var layerInstances = Object.values(baseLayers);
            
        function changeLayer() {
            map.removeLayer(layerInstances[currentLayerIndex]);
            
            currentLayerIndex = (currentLayerIndex + 1) % layerInstances.length;
            
            layerInstances[currentLayerIndex].addTo(map);
        }

        function getAvailabilityColor(availability) {
            if (!availability) return 'red';
            
            const availText = availability.toLowerCase();
            if (availText.includes('today') || availText.includes('1 day')) {
                return 'green';
            } else if (availText.includes('2 day')) {
                return 'yellow';
            }
            return 'red';
        }

        function createCustomMarker(color) {
            return L.divIcon({
                className: `marker-${color}`,
                html: '',
                iconSize: [15, 15]
            });
        }

        // Manual data initialization
        const doctorsData = {
            doctors: [
                {
                    name: "Dr. Sarah Johnson",
                    specialty: "Cardiologist",
                    latitude: 17.411482,
                    longitude: 78.403532,
                    consultations: {
                        digital: {
                            availability: "Available today"
                        }
                    }
                },
                {
                    name: "Dr. Michael Smith",
                    specialty: "Neurologist",
                    latitude: 17.438335,
                    longitude: 78.504831,
                    consultations: {
                        clinic: {
                            availability: "2 days"
                        }
                    }
                },
                {
                    name: "Dr. Emily Brown",
                    specialty: "Pediatrician",
                    latitude: 17.399805,
                    longitude: 78.479150,
                    consultations: {
                        digital: {
                            availability: "3 days"
                        }
                    }
                },
                {
                    name: "Dr. James Wilson",
                    specialty: "Orthopedic",
                    latitude: 17.342864,
                    longitude: 78.506943,
                    consultations: {
                        clinic: {
                            availability: "1 day"
                        }
                    }
                },
                {
                    name: "Dr. Lisa Anderson",
                    specialty: "Dermatologist",
                    latitude: 18.456920,
                    longitude: 79.135035,
                    consultations: {
                        digital: {
                            availability: "2 days"
                        }
                    }
                },
                {
                    latitude: 17.399805,
                    longitude: 78.506943,
                    id: "dr-sanatan-satapathy-20eb06f2-2cc7-47e8-928d-5c94b0af06f5?source=Listing_Page",
                    name: "Dr. Sanatan Satapathy",
                    specialty: "Neurosurgeon",
                    experience: "10 Years",
                    qualifications: "MBBS , MS (General surgery) , MCH (Neurosurgery)",
                    city: "Bhubaneswar",
                    clinic: "Dr Sanatan Satapathy, Bhubaneswar",
                    consultations: {
                      digital: null,
                      clinic: {
                        price: "₹500",
                        availability: "Available in 16 minutes"
                      }
                    },
                    profile_url: "https://www.apollo247.com/doctors/dr-sanatan-satapathy-20eb06f2-2cc7-47e8-928d-5c94b0af06f5?source=Listing_Page"
                },
                {
                    latitude: 18.035563,
                    longitude: 79.629879,
                    id: "dr-gaurav-tyagi-1a258739-30f5-47f5-950f-44e2ceb87014?source=Listing_Page",
                    name: "Dr Gaurav Tyagi",
                    specialty: "Neurosurgeon",
                    experience: "8 Years",
                    qualifications: "MBBS, MS, MCh (NIMHANS) Clinical Fellowship in Skull base Surgery",
                    city: "Delhi",
                    clinic: "Apollo Hospitals Indraprastha, Delhi",
                    consultations: {
                      digital: {
                        price: "₹1500",
                        availability: "Available tomorrow at 02:30 AM"
                      },
                      clinic: null
                    },
                    profile_url: "https://www.apollo247.com/doctors/dr-gaurav-tyagi-1a258739-30f5-47f5-950f-44e2ceb87014?source=Listing_Page"
                },
            ]
        };

        {% comment %} function initializeMap() {
            const bounds = L.latLngBounds();
            
            doctorsData.doctors.forEach(doctor => {
                const availability = doctor.consultations.digital?.availability || 
                                   doctor.consultations.clinic?.availability || 
                                   'Not available';
                
                const availColor = getAvailabilityColor(availability);
                const customMarker = createCustomMarker(availColor);
                
                const popupContent = `
                    <div class="availability-popup">
                        <strong>${doctor.name}</strong>
                        <span>${doctor.specialty}</span>
                        <span style="color: ${availColor === 'green' ? '#22c55e' : 
                                            availColor === 'yellow' ? '#eab308' : 
                                            '#ef4444'}">
                            ${availability}
                        </span>
                    </div>
                `;
                
                const marker = L.marker([doctor.latitude, doctor.longitude], {
                    icon: customMarker
                }).bindPopup(popupContent);
                
                markers.push(marker);
                marker.addTo(map);
                bounds.extend([doctor.latitude, doctor.longitude]);
            });
            
            map.fitBounds(bounds);
        } {% endcomment %}

        function spreadMarkers(doctors) {
           
            const coordMap = new Map();
            
            
            doctors.forEach(doctor => {
                const key = `${doctor.latitude},${doctor.longitude}`;
                if (!coordMap.has(key)) {
                    coordMap.set(key, []);
                }
                coordMap.get(key).push(doctor);
            });
            
            
            const markers = [];
            const SPREAD_DISTANCE = 0.0002; 
            
            coordMap.forEach((doctorsAtLocation, coord) => {
                const [baseLat, baseLng] = coord.split(',').map(Number);
                
                doctorsAtLocation.forEach((doctor, index) => {
                    if (index === 0) {
                        
                        doctor.adjustedLat = baseLat;
                        doctor.adjustedLng = baseLng;
                    } else {
                        
                        const angle = (2 * Math.PI * index) / doctorsAtLocation.length;
                        doctor.adjustedLat = baseLat + SPREAD_DISTANCE * Math.cos(angle);
                        doctor.adjustedLng = baseLng + SPREAD_DISTANCE * Math.sin(angle);
                    }
                });
            });
            
            return doctors;
        }
        
        {% comment %} function initializeMap() {
            const bounds = L.latLngBounds();
            
            // Apply spreading to markers
            const spreadDoctors = spreadMarkers(doctorsData.doctors);
            
            spreadDoctors.forEach(doctor => {
                const availability = doctor.consultations.digital?.availability || 
                                   doctor.consultations.clinic?.availability || 
                                   'Not available';
                
                const availColor = getAvailabilityColor(availability);
                const customMarker = createCustomMarker(availColor);
                
                const popupContent = `
                    <div class="availability-popup">
                        <strong>${doctor.name}</strong>
                        <span>${doctor.specialty}</span>
                        <span style="color: ${availColor === 'green' ? '#22c55e' : 
                                            availColor === 'yellow' ? '#eab308' : 
                                            '#ef4444'}">
                            ${availability}
                        </span>
                    </div>
                `;
                
                // Use adjusted coordinates for marker placement
                const marker = L.marker([doctor.adjustedLat, doctor.adjustedLng], {
                    icon: customMarker
                }).bindPopup(popupContent);

                const circle = L.circle([doctor.adjustedLat, doctor.adjustedLng], {
                    color: availColor,
                    fillColor: availColor,
                    fillOpacity: 0.2,
                    radius: 50 // radius in meters
                });

                markers.push(marker);
                markers.push(circle);
                
                marker.addTo(map);
                circle.addTo(map);

                bounds.extend([doctor.adjustedLat, doctor.adjustedLng]);
            });
            
            map.fitBounds(bounds);
        } {% endcomment %}
        
        function initializeMap() {
            const bounds = L.latLngBounds();
            
          
            const spreadDoctors = spreadMarkers(doctorsData.doctors);
            
            spreadDoctors.forEach(doctor => {
                const availability = doctor.consultations.digital?.availability || 
                                   doctor.consultations.clinic?.availability || 
                                   'Not available';
                
                const availColor = getAvailabilityColor(availability);
                const customMarker = createCustomMarker(availColor);
                
                
                const circleColor = availColor === 'green' ? '#22c55e' : 
                                  availColor === 'yellow' ? '#eab308' : 
                                  '#ef4444';
                
                const popupContent = `
                    <div class="availability-popup">
                        <strong>${doctor.name}</strong>
                        <span>${doctor.specialty}</span>
                        <span style="color: ${circleColor}">
                            ${availability}
                        </span>
                    </div>
                `;
                
              
                const marker = L.marker([doctor.adjustedLat, doctor.adjustedLng], {
                    icon: customMarker
                }).bindPopup(popupContent);
        
                
                const circle = L.circle([doctor.adjustedLat, doctor.adjustedLng], {
                    color: circleColor,
                    fillColor: circleColor,
                    fillOpacity: 0.1,
                    weight: 2,
                    radius: 2000  
                });
        
                markers.push(marker);
                markers.push(circle);
                
                
                circle.addTo(map);
                marker.addTo(map);
        
                bounds.extend([doctor.adjustedLat, doctor.adjustedLng]);
            });
            
            map.fitBounds(bounds);
        }

        document.addEventListener('DOMContentLoaded', () => {
            initializeMap();
        });


        function togglePanel() {
            const panel = document.getElementById('bookingPanel');
            panel.classList.toggle('open');
           
            const button = document.querySelector('.toggle-button');
            const svg = button.querySelector('svg');
           
            if (panel.classList.contains('open')) {
                svg.innerHTML = '<polyline points="9 18 15 12 9 6"></polyline>';
            } else {
                svg.innerHTML = '<polyline points="15 18 9 12 15 6"></polyline>';
            }
        }

        function handleSubmit(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData);
            console.log('Form submitted:', data);
            
        }
    </script>


</body>
</html>
{% endblock content %}